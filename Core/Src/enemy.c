#include "enemy.h"
#include "kirby.h"

const uint8_t ENEMY_WIDTH = 32;
const uint8_t ENEMY_HEIGHT = 28;
uint8_t showEnemy = 1;

void Enemy_displayEnemyFacingLeft(uint8_t fullHeight, uint16_t kirbyX, uint8_t spriteWidth, uint8_t spriteHeight, uint8_t spriteOffset, const uint16_t* frame, uint16_t xPos, uint16_t yPos) {
	for (int x = 0; x < spriteWidth; x++) {
		if (x + xPos - kirbyX > 160) {
			break;
		}
		uint16_t displayXPos = (xPos + spriteOffset + spriteWidth - x) % 320;
		for (int y = spriteHeight - 1; y >= 0; y--) {
		  uint16_t displayYPos = yPos + y + (fullHeight - spriteHeight);
		  uint16_t color = frame[y * spriteWidth + x];
		  if (color == 0x024A) {
			  uint16_t newColor = platformImg[882 * (displayYPos) + (xPos + spriteOffset + spriteWidth - x)];
			  color = newColor;
		  }
		  LCD_DrawDot(displayXPos, displayYPos, color);
		}
	}
}

const uint16_t ENEMY_IDLE_SPRITE[600] = {
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x0000,0x0000,0xC1CF,0xFB53,0xF51E,0xFB53,0xFB53,0xC1CF,0x0000,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x0000,0xC1CF,0xF51E,0xF6DD,0xF51E,0xF51E,0xFB53,0x7949,0x0000,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x0000,0xC1CF,0xF51E,0xF6DD,0xF6DD,0xF51E,0xF51E,0x7949,0x48C5,0x0000,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x0000,0xFB53,0xF51E,0xF6DD,0xF6DD,0xF51E,0xF51E,0x48C5,0x48C5,0x0000,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x0000,0xC1CF,0xF51E,0xF51E,0xF6DD,0xF6DD,0xF51E,0xFB53,0x48C5,0x48C5,0x0000,0x0000,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x0000,0x7949,0xE250,0xF51E,0xF51E,0xF51E,0xFB53,0xE250,0xC1CF,0x7949,0x7949,0x7949,0x48C5,0x0000,0x0000,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x0000,0x0000,0xC1CF,0xF51E,0xFB53,0xF51E,0xE250,0xC1CF,0xFB53,0xF51E,0xF51E,0xF51E,0xE250,0xC1CF,0xC1CF,0xE250,0x7949,0x0000,0x024A,0x024A,0x024A,0x024A,
0x024A,0x0000,0x0000,0xC1CF,0xFB53,0xFB53,0xF51E,0xFB53,0xC1CF,0x7949,0xE250,0xF51E,0xF6DD,0xF6DD,0xF6DD,0xF51E,0xE250,0xC1CF,0xC1CF,0xE250,0x7949,0x0000,0x024A,0x024A,0x024A,
0x024A,0x0000,0xC1CF,0xFB53,0xFB53,0xFB53,0xF51E,0xC1CF,0x7949,0xC1CF,0xFB53,0xF51E,0xF51E,0xFB53,0xFB53,0xE250,0xE250,0xC1CF,0x7949,0x7949,0x48C5,0x0000,0x024A,0x024A,0x024A,
0x024A,0x024A,0x0000,0x48C5,0x48C5,0x48C5,0x7949,0x7949,0x7949,0xE250,0xFB53,0xE250,0xFB53,0xF51E,0xF51E,0xF51E,0xF51E,0xF51E,0xFB53,0xE250,0xC1CF,0xE250,0x0000,0x024A,0x024A,
0x024A,0x024A,0x0000,0x7949,0xFB53,0xFB53,0xF51E,0xF51E,0xE250,0xC1CF,0xE250,0xFB53,0xF51E,0xF51E,0xF51E,0xF6DD,0xF6DD,0xF51E,0xF51E,0xFB53,0xE250,0xC1CF,0xE250,0x0000,0x024A,
0x024A,0x024A,0x0000,0xC1CF,0x7949,0xC1CF,0xFB53,0xF6DD,0xF51E,0xE250,0xC1CF,0xFB53,0xF51E,0xFB53,0xE250,0xC1CF,0x7949,0x48C5,0x48C5,0x48C5,0x7949,0xC1CF,0x7949,0x0000,0x024A,
0x024A,0x024A,0x0000,0x48C5,0x48C5,0x48C5,0x7949,0xFB53,0xF51E,0xE250,0x7949,0xE250,0x7949,0x48C5,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x7949,0x48C5,0x0000,0x024A,
0x024A,0x0000,0x2814,0x18D7,0x18D7,0x2814,0x48C5,0x7949,0xFB53,0xC1CF,0x7949,0x48C5,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x48C5,0x18D7,0x0000,
0x0000,0x2814,0x011E,0x011E,0x011E,0x011E,0x2814,0x7949,0xC1CF,0x7949,0x48C5,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x48C5,0x18D7,0x0000,
0x0000,0x18D7,0x029E,0x029E,0x011E,0x011E,0x18D7,0x7949,0xC1CF,0x48C5,0x7949,0x7949,0x48C5,0x48C5,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x48C5,0x0000,0x011E,0x0000,
0x0000,0x011E,0x011E,0x029E,0x18D7,0x011E,0x18D7,0x48C5,0x48C5,0x7949,0xE250,0xFB53,0xFB53,0xF51E,0xF51E,0xF6DD,0xF6DD,0xF51E,0xE250,0xC1CF,0xC1CF,0xE250,0x0000,0x011E,0x0000,
0x0000,0x18D7,0x011E,0x011E,0x2814,0x18D7,0x48C5,0x7949,0xC1CF,0xC1CF,0xC1CF,0xE250,0xFB53,0xF51E,0xF51E,0xF51E,0xF51E,0xF51E,0xE250,0xC1CF,0xC1CF,0xE250,0x0000,0x18D7,0x0000,
0x0000,0x2814,0x18D7,0x18D7,0x18D7,0x48C5,0x0000,0x0000,0x48C5,0x48C5,0x48C5,0x7949,0xC1CF,0xE250,0xFB53,0xFB53,0xFB53,0xFB53,0xE250,0xC1CF,0x48C5,0x48C5,0x0000,0x0000,0x024A,
0x024A,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x738E,0x738E,0x9CD3,0xCE59,0x738E,0x48C5,0x7949,0xC1CF,0xC1CF,0xC1CF,0xC1CF,0xC1CF,0x48C5,0x9CD3,0x9CD3,0x738E,0x0000,0x024A,
0x024A,0x024A,0x024A,0x024A,0x0000,0x738E,0x738E,0x9CD3,0xF6DD,0xF6DD,0xF6DD,0xCE59,0x738E,0x48C5,0x7949,0x7949,0x7949,0x48C5,0x48C5,0x9CD3,0xCE59,0xCE59,0x9CD3,0x0000,0x024A,
0x024A,0x024A,0x024A,0x024A,0x0000,0x738E,0x9CD3,0x9CD3,0xCE59,0xF6DD,0xCE59,0x9CD3,0x738E,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A
};

const uint16_t ENEMY_ATTACKING_SPRITE[896] = {
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0xA577,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0x4BAF,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0xA577,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0xA577,0xF6DD,0xF6DD,0xF6DD,0xF59D,0xF51E,0xF51E,0xF51E,0xF51E,0xF51E,0xF51E,0xF51E,0xF51E,0xF51E,0xF63D,0xF6DD,0xF6DD,0xF6DD,0x4BAF,
0x024A,0x024A,0x024A,0xA577,0xF6DD,0xF6DD,0xF6DD,0x4BAF,0x024A,0x024A,0x024A,0xA577,0xF6DD,0xF6DD,0xF59D,0xF51E,0xF51E,0xF51E,0xF51E,0xF51E,0xF51E,0xF51E,0xF51E,0xF51E,0xF51E,0xF63D,0xF6DD,0xF6DD,0xF6DD,0xF59D,0x4B10,0x024A,
0x024A,0x024A,0x024A,0x024A,0xA437,0xF51E,0xF51E,0xF63D,0xF6DD,0xF6DD,0xF6DD,0xE3B4,0xE250,0xF2F2,0xFB53,0xFB53,0xE290,0xE250,0xEC39,0xF51E,0xF51E,0xF63D,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF59D,0x4B10,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0xA437,0xF51E,0xF51E,0xF51E,0xCAD3,0xD20F,0xF2F2,0xF47A,0xF51E,0xF51E,0xF51E,0xF51E,0x6197,0x2814,0x2814,0x2814,0xB4BA,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF59D,0xF51E,0x4B10,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0xA437,0xF51E,0x9A6F,0xC1ED,0xF2F2,0xF47A,0xF51E,0xF51E,0xF51E,0xF51E,0x6197,0x1896,0x00FB,0x011E,0x10D9,0x2034,0xB4BA,0xF6DD,0xF6DD,0xF59D,0xF51E,0x4B10,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x00A3,0x812A,0xE2D1,0xF47A,0xF51E,0xF51E,0xF51E,0xF51E,0x6197,0x1896,0x00FB,0x021E,0x029E,0x017E,0x10D9,0x2034,0xB37B,0xF51E,0xF51E,0x4B10,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x00A3,0x0000,0x0000,0x50E6,0xC1ED,0xEC39,0xF63D,0xF6DD,0xF59D,0xF51E,0xF3D6,0x6113,0x08BB,0x011E,0x011E,0x021E,0x029E,0x017E,0x1857,0xB37B,0xF51E,0x4B10,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x00A3,0x4A69,0x738E,0x5187,0x996C,0xE2D1,0xF5BA,0xF6DD,0xF59D,0xF51E,0xF63D,0x6216,0x1896,0x00FB,0x011E,0x011E,0x011E,0x021E,0x017E,0x1857,0xB37B,0x4B10,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x00A3,0x6B4D,0xBDD7,0xA534,0x61E9,0x996C,0xE2D1,0xF47A,0xF51E,0xF3D6,0xF5BA,0xF6DD,0x6216,0x1896,0x00FB,0x011E,0x011E,0x011E,0x011E,0x10D9,0x2034,0x60EC,0x21E9,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x00A3,0x4A69,0xAD75,0xCE59,0xCE59,0x92CD,0xC1ED,0xF2F2,0xF47A,0xF3D6,0xF5BA,0xF59D,0xF3D6,0x6113,0x1896,0x18D7,0x00FB,0x011E,0x011E,0x10D9,0x2034,0xBA53,0x7989,0x11C8,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x00A3,0x6B4D,0xD63A,0xD67A,0xCE59,0x92CD,0xA98D,0xD20F,0xF2F2,0xFB53,0xF47A,0xF3D6,0xD230,0x896A,0x4070,0x1896,0x18D7,0x18D7,0x2034,0x2814,0xBA53,0xFB53,0xD230,0x6908,0x11C8,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x00A3,0x4A69,0xAD75,0xE69B,0xD67A,0xCE59,0x92CD,0xA98D,0xD20F,0xE250,0xF2F2,0xF47A,0xCAD3,0x896A,0x7949,0x7949,0x4070,0x2814,0x2814,0x9130,0xE2D1,0xFB53,0xFB53,0xE290,0x7128,0x11C8,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x00A3,0x6B4D,0xD63A,0xD67A,0xCE59,0xA534,0x61E9,0x996C,0xC1CF,0xD20F,0xE250,0xEC39,0xCAD3,0x896A,0x7949,0x7949,0x7949,0x7949,0xC1ED,0xC9EF,0xC1CF,0xD20F,0xE250,0xE250,0x7128,0x11C8,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x00A3,0x6B4D,0xD63A,0xD67A,0xA534,0x7BEF,0x2104,0x50E6,0xA98D,0xD20F,0xC9EF,0xE2D1,0xD230,0xC1CF,0x896A,0x7949,0x7949,0xA98D,0xD20F,0xC9EF,0xE2D1,0xF47A,0xF3D6,0xD230,0x3884,0x0187,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x00A3,0x4A69,0x8C71,0x9CD3,0x7BEF,0x2104,0x0000,0x3083,0x996C,0xC1CF,0xC1CF,0xC1CF,0xD20F,0xC9EF,0xC1CF,0xC1CF,0xC1CF,0xC1CF,0x896A,0xD2B0,0xF47A,0xF63D,0xF59D,0xE314,0x40A4,0x0187,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x00A3,0x0000,0x0000,0x0000,0x0187,0x024A,0x00A3,0x50E6,0xA98D,0xC1CF,0xC1CF,0x896A,0xA98D,0xC1CF,0xC1CF,0xC1CF,0x896A,0x50E6,0xB1CC,0xF2F2,0xF47A,0xF51E,0xE314,0x40A4,0x0187,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x00A3,0x3083,0x6907,0xA98D,0xC1CF,0xC1CF,0x896A,0x7949,0x7949,0x7949,0x50E6,0x48C5,0x48C5,0x6907,0xC1ED,0xF2F2,0xD230,0x3884,0x0187,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x00A3,0x3083,0x6907,0xA98D,0xC1CF,0xC1CF,0xC1CF,0xC1CF,0xC1CF,0x896A,0x50E6,0x48C5,0x48C5,0x48C5,0x6907,0x2062,0x0187,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x00A3,0x3083,0x6907,0xA98D,0xC1CF,0xC1CF,0xC1CF,0xC1CF,0x896A,0x7949,0x50E6,0x48C5,0x48C5,0x1021,0x0187,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x00A3,0x0000,0x3083,0x6907,0x7949,0x7949,0x72CC,0x8C71,0x9CD3,0x9CD3,0x9CD3,0x2965,0x0187,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x00A3,0x0000,0x4A69,0x8C71,0x9CD3,0xBDD7,0xE69B,0xF6DD,0xD67A,0xA534,0x2965,0x0187,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x00A3,0x4A69,0x8C71,0x9CD3,0xBDD7,0xCE59,0xCE59,0xCE59,0xA534,0x7BEF,0x2104,0x0187,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x00A3,0x4A69,0x8C71,0x9CD3,0x9CD3,0x9CD3,0x9CD3,0x7BEF,0x2104,0x0187,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x00A3,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0187,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A
};

// 23x16
const uint16_t BOOMERANG_SPRITE_0[368] = {
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x1A8C,0xCC9B,0xF51E,0xF51E,0xF51E,0xF51E,0xF51E,0xD4BB,0x2ACD,0x2ACD,0x2ACD,0x22AD,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x2ACD,0x4B10,0xF51E,0xF51E,0xF51E,0xF51E,0xF55D,0xF55D,0xF55D,0xF55D,0xF55D,0xD4BB,0x2ACD,0x22AD,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x2ACD,0x4B10,0xF51E,0xF55D,0xF55D,0xF55D,0xF51E,0xF53D,0xF67D,0xF6DD,0xF6DD,0xF6DD,0xF69D,0xF55D,0xF55D,0xD4BB,0x22AD,0x024A,0x024A,
0x024A,0x024A,0x024A,0x4B10,0xF51E,0xF51E,0xF53D,0xF67D,0xF6DD,0xF69D,0xF55D,0xF51E,0xF55D,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6BD,0xF63D,0xF51E,0xCC9B,0x024A,0x024A,
0x024A,0x024A,0x4B0F,0xF4BC,0xF4BC,0xF4BC,0xF51E,0xF53D,0xF67D,0xF6DD,0xF67D,0xF51E,0xF55D,0xF6DD,0xF6DD,0xF6BD,0xF67D,0xF63D,0xF51E,0xF51E,0xD4BB,0x22AD,0x024A,
0x024A,0x4ACE,0xF47A,0xFB53,0xFB53,0xF374,0xF4BC,0xF51E,0xF55D,0xF6DD,0xF67D,0xF51E,0xF59D,0xF6DD,0xF6BD,0xF63D,0xF51E,0xF51E,0xF51E,0xF51E,0xF51E,0xCC9B,0x024A,
0x428C,0xCB11,0xCB11,0xD311,0xFB53,0xFB53,0xF374,0xF4BC,0xF53D,0xF67D,0xF67D,0xF55D,0xF6BD,0xF67D,0xF63D,0xF51E,0xF51E,0xF51E,0xF51E,0xF4FD,0xF4BC,0xD459,0x226B,
0xAAF0,0x024A,0x024A,0x1A6B,0xCB11,0xD311,0xFB53,0xF374,0xF4BC,0xF53D,0xF63D,0xF53D,0xF63D,0xF51E,0xF51E,0xF4FD,0xF4BC,0xF4BC,0xF4BC,0xF47A,0xFB53,0xFB53,0xD311,
0x024A,0x024A,0x024A,0x024A,0x024A,0x1A6B,0xCB11,0xD311,0xF374,0xF4BC,0xF4BC,0xF4BC,0xF4BC,0xF4BC,0xF4BC,0xF47A,0xFB53,0xFB53,0xFB53,0xFB53,0xFB53,0xFB53,0xD311,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x1A6B,0xCB11,0xCB11,0xCB11,0xD311,0xFB53,0xF332,0xF312,0xF312,0xF312,0xF312,0xF312,0xF312,0xF312,0xFB53,0xD311,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x1A6B,0xCB11,0xCAF1,0xE250,0xE250,0xE250,0xE270,0xE270,0xE270,0xE270,0xF312,0xCAF1,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x1A4A,0xBA4E,0xBA4F,0xE270,0xF312,0xF312,0xF332,0xE270,0xDA4F,0x9A4E,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x1A4A,0xBA4E,0xBA4F,0xE270,0xF312,0xF2F2,0xBA4F,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x1A4A,0xBA4F,0xE250,0xDA4F,0x9A4E,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x224A,0xDA4F,0x9A4E,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x1A4A,0x9A4E,0x024A,0x024A,0x024A
};

const uint16_t BOOMERANG_SPRITE_1[368] = {
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0xECFD,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0xF51E,0xECFD,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0xF51E,0xF51E,0xF51E,0xECFD,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0xF51E,0xF51E,0xF6DD,0xF51E,0xECFD,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0xF51E,0xF51E,0xF6DD,0xF6DD,0xF6DD,0xECFD,0x024A,
0xDA50,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0xF51E,0xF51E,0xF51E,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF51E,0xECFD,
0xE250,0xE250,0xDA50,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0xF51E,0xF51E,0xF51E,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF51E,0xECFD,
0xE250,0xFB53,0xE250,0xE250,0xE250,0xE250,0xE250,0xE250,0xE250,0xFB53,0xFB53,0xFB53,0xFB53,0xFB53,0xF51E,0xF51E,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF6DD,0xF51E,0xECFD,
0xE250,0xFB53,0xF51D,0xFB53,0xE250,0xE250,0xFB53,0xFB53,0xF51E,0xF6DD,0xF6DD,0xF51E,0xF51D,0xFB53,0xFB53,0xF51E,0xF51E,0xF51E,0xF6DD,0xF6DD,0xF6DD,0xF51E,0xECFD,
0x024A,0xFB53,0xF51E,0xF6DD,0xF51E,0xF51E,0xF6DD,0xF6DD,0xF6DD,0xF51D,0xFB53,0xFB53,0xF51E,0xF51D,0xFB53,0xFB53,0xF51E,0xF51E,0xF51E,0xF6DD,0xF51E,0xECFD,0x024A,
0x024A,0xE250,0xFB53,0xF51E,0xF6DD,0xF6DD,0xF6DD,0xF51D,0xFB53,0xE250,0xE250,0xFB53,0xF51E,0xF51D,0xFB53,0xFB53,0xF51E,0xF51E,0xF51E,0xF51E,0xF51E,0xECFD,0x024A,
0x024A,0x024A,0xFB53,0xFB53,0xF51E,0xF51D,0xFB53,0xE250,0xE250,0xE250,0xE250,0xFB53,0xFB53,0xF51E,0xF51D,0xFB53,0xFB53,0xF51E,0xF51E,0xF51E,0xECFD,0x024A,0x024A,
0x024A,0x024A,0x024A,0xFB53,0xFB53,0xE250,0xE250,0xE250,0xE250,0xE250,0xFB53,0xFB53,0xFB53,0xF51E,0xF51D,0xFB53,0xFB53,0xF51E,0xF51E,0xECFD,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0xE250,0xE250,0xE250,0xE250,0xE250,0xFB53,0xFB53,0xFB53,0xF51E,0xF51E,0xF51E,0xF51E,0xECFD,0x024A,0x024A,0x024A,0x024A,0x024A,
0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0xE250,0xFB53,0xFB53,0xFB53,0xFB53,0xF51E,0xECFD,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A,0x024A
};

static uint8_t remainingTicks = 20;
static uint8_t boomerangTicks = 10;
static enum Direction boomerangDirection = LEFT;
static uint16_t boomerangX = 384;
static uint8_t boomerangSprite = 0;
static enum EnemyState state = ENEMY_IDLE;
static uint16_t HEIGHT = 6*24 - ENEMY_HEIGHT;
static uint8_t boomerangLock = 1;

void Enemy_redrawColumnLeft() {
	// Redraw the first column
	for (int y = 0; y < 16; y++) {
	  uint16_t displayX = (boomerangX) % 320;
	  uint16_t displayY = HEIGHT + y;
	  uint16_t color = platformImg[882 * (displayY) + (boomerangX)];
	  LCD_DrawDot(displayX, displayY, color);
	}
}

void Enemy_redrawColumnRight() {
	// Redraw the last column
	for (int y = 0; y < 16; y++) {
		uint16_t displayX = (boomerangX + 23) % 320;
		uint16_t displayY = HEIGHT + y;
		uint16_t color = platformImg[882 * (displayY) + boomerangX + 23];
		LCD_DrawDot(displayX, displayY, color);
	}
}

void Enemy_eraseBoomerang() {
	for (int y = 0; y < 16; y++) {
		for (int x = 0; x < 23; x++) {
			uint16_t displayX = (boomerangX + x) % 320;
			uint16_t displayY = HEIGHT + y;
			uint16_t color = platformImg[882 * displayY + boomerangX + x];
			LCD_DrawDot(displayX, displayY, color);
		}
	}
}

void Enemy_eraseEnemy() {
	for (int y = 0; y < ENEMY_HEIGHT; y++) {
		for (int x = 0; x < ENEMY_WIDTH; x++) {
			uint16_t displayX = (416 + x) % 320;
			uint16_t displayY = HEIGHT + y;
			uint16_t color = platformImg[882 * displayY + 416 + x];
			LCD_DrawDot(displayX, displayY, color);
		}
	}
}

void Enemy_updateEnemy(const struct Kirby* kirby) {
	uint16_t kirbyX = kirby->xPos;
	if (416 - kirbyX > 160) {
		return;
	}

	if (remainingTicks == 0) {
		remainingTicks = 20;
		state = !state;
	}

	if (boomerangTicks == 0) {
		if (boomerangDirection == LEFT) {
			boomerangDirection = RIGHT;
			boomerangTicks = 10;
		} else {
			Enemy_eraseBoomerang();
			boomerangDirection = LEFT;
			boomerangTicks = 10;
			boomerangX = 384;
			boomerangLock = 0;
		}
	}

	if (state == ENEMY_IDLE) {
		Enemy_displayEnemyFacingLeft(ENEMY_HEIGHT, kirbyX, 25, 24, 3, ENEMY_IDLE_SPRITE, 416, HEIGHT);
		boomerangLock = 1;
	} else {
		// Sir Kibble
		Enemy_displayEnemyFacingLeft(ENEMY_HEIGHT, kirbyX, 32, 28, 0, ENEMY_ATTACKING_SPRITE, 416, HEIGHT);

		// Boomerang
		if (boomerangDirection == LEFT) {
			Enemy_redrawColumnRight();
			boomerangX--;
		} else {
			Enemy_redrawColumnLeft();
			boomerangX++;
		}
		const uint16_t* sprite = boomerangSprite == 0 ? BOOMERANG_SPRITE_0 : BOOMERANG_SPRITE_1;
		if (boomerangLock) {
			Enemy_displayEnemyFacingLeft(16, kirbyX, 23, 16, 0, sprite, boomerangX, HEIGHT);
		}
		boomerangSprite = !boomerangSprite;
		boomerangTicks--;
	}
	remainingTicks--;
}
